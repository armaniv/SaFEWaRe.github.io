---
title: "Micro-Id-Gym: a Flexible Tool for Pen-testing Identity Management Protocols in the Wild and in the Laboratory"
paper: MicroIDGym_2020

people:
    - AndreaBisegna_T_FBK
    - RobertoCarbone_R_FBK
    - GiulioPellizzari_UniTN
    - SilvioRanise_H_FBK

peopleOrder: surname
      
---

### SAML checks
In Section 3.1 of the paper we mentioned a list of SAML tests. The table below reports all the tests that the Pentesting tool does in SAML implementations.
\begin{table}[h!b]
	\fontsize{8}{10}\selectfont 
	\centering
	\caption{Collection of Security Tests targeting \textit{Client} role.}\label{table:tests-client} 
	 \vspace{0.3em}
	\renewcommand{\arraystretch}{1.2}
	 \begin{tabular}{@{}p{0.1\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}@{}}
	\begin{tabular}{@{}p{3cm}llp{4cm}p{4cm}@{}} 
		\toprule
		 compliance, active/passive, 
		\textbf{Security Test} & \textbf{Prot.}&\textbf{P/A}& \textbf{Description} & \textbf{Mitigation}\\\midrule
		
		  %%%%%%%%%%%%%%%%Client%%%%%%%%%%%%%%%%%%%%%%%%
		                \multicolumn{2}{l}{\textbf{Target: Client Role}}&&~~~~$\vdots$&\\\midrule
				\multicolumn{5}{l}{\textbf{Target: Client Role}}\\\midrule
		& Any &&&&\\
		& SAML &&&&\\
		& OAuth/OIDC &&&&\\
		Session Fixation Test & S &A& Check whether the implementation suffers the session vulnerability.&Handle properly the user sessions.\\
		
		Alteration of the Relay State parameter& S &A&Changes value of Relay State parameter.&Sanitize the value of Relay State parameter.\\
		
		
		Missing check on Audience element\cite{ltt}&S&P& Check whether the Audience element is present in the SAML assertion & Configure the Client to accept only SAML assertions with Audience element \\
		
		Missing OneTimeUse attribute\cite{ltt}&S&P& Check whether the OneTimeUse attribute is present in the SAML assertion & Configure the Client to accept only SAML assertions with OneTimeUse attribute \\
		
		Missing check on Destination element\cite{ltt}&S&P& Check whether the Destination element is present in the SAML assertion & Configure the Client to accept only SAML assertions with Destination element \\
		
		Missing check on NotOnOrAfter attribute\cite{ltt}&S&P& Check whether the NotOnOrAfter attribute is present in the SAML assertion & Configure the Client to accept only SAML assertions with NotOnOrAfter attribute \\
		
		Missing check on the InResponseTo attribute\cite{ltt}&S&P& Check whether the InResponseTo attribute is present in the SAML assertion & Configure the Client to accept only SAML assertions with InResponseTo attribute \\
		
		Missing check on Recipient element\cite{ltt}&S&P& Check whether the Recipient attribute is present in the SAML assertion & Configure the Client to accept only SAML assertions with Recipient attribute \\ 
		
		%suffers the session vulnerability causing SSO Login CSRF attack.  
		
	%	\bottomrule
		
		
	%\end{tabular}
	
%\end{table}



\begin{table}[h!b]
	\fontsize{8}{10}\selectfont 
	\centering
	\caption{Collection of Security Tests targeting \textit{Any} role.}\label{table:tests-any} 
	% \vspace{0.3em}
	\renewcommand{\arraystretch}{1.2}
	% \begin{tabular}{@{}p{0.1\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}p{0.2\textwidth}@{}}
	\scalebox{0.5}{
	\begin{tabular}{@{}p{3cm}llp{4cm}p{4cm}@{}} 
		\toprule
		% compliance, active/passive, 
		\textbf{Security Test} & \textbf{Prot.}&\textbf{P/A}& \textbf{Description} & \textbf{Mitigation}\\\midrule
		%%%%%%%%%%%%%%%%General%%%%%%%%%%%%%%%%%%%%%%%%
		%	\multicolumn{5}{l}{\textbf{Target: Any}}\\\midrule
		%Use of HTTPS & - &P&Check if all HTTP messages communicates over a secure channel.&Change conf.~of the web server and forward unsecured HTTP messages to HTTPS.\\
		%Clickjaking Prevention & - &P&Check if all the HTTP messages has the header X-FRAME-OPTIONS set as DENY or SAME-ORIGIN.&Set DENY or SAME-ORIGIN the header X-FRAME-OPTIONS.\\
		Missing check on Canonicalization algorithm\cite{ltt}&S&P& Check if the Canonicalization algorithm used by the XML parser encode also comments & Change XML parser Canonicalization algorithm to one that includes comments\\
		\\\bottomrule
		% \multicolumn{5}{c}{$\vdots$}\\
		
	\end{tabular}
}
\end{table}



### Video
<video width="640" height="480" controls>
    <source src="assets/ETAA2020/[nomedelfile].[ext]" type="video/mp4">
</video>
<video width="640" height="480" controls>
    <source src="assets/ETAA2020/[nomedelfile].[ext]" type="video/mp4">
</video>

### Tools
Micro-Id-Gym a tool which offering on the one hand (in the laboratory) an easy way to configure the production environment in a sandbox where pentesters can develop hands-on experiences on how IdM solutions work, performing attacks with high impacts and better understand the underlying security issues. On the other hand (in the wild) a set of pentesting tools for the automatic security analysis of IdM protocols are provided.

**Download**:
- Click <a href="https://github.com/stfbk/micro-id-gym/">here</a> to download the tool.
