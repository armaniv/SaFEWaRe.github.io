<div>
<img src="assets\CODASPY2021\Msc.png" style="zoom:60%" align="left">
<ol type="A">
    <li>(i.e., login with the enterprise account) is represented by Step 2 on the left. It corresponds to the check of a valid login session with Google (i.e. the presence of a valid Google access token AT<sub>G</sub>).
    <li>(i.e., fetching of the job list) is represented by Steps 3-4. In the print job list request, the <i>Print Releaser</i> app sends the user token (AT<sub>G</sub>) and the identifier of the <i>Virtual Printer</i> (Spooler ID) to Google Cloud Print. As answer, it receives the list of the jobs (JobID1, JobID2,...) that the user has previously uploaded in Google Cloud Print together with other information (e.g., the job state).
    <li>(i.e., selection of print jobs) is represented by Steps 5-6.
    <li>(i.e., QR code scanning) is represented by Steps 7-8, where the QR code contains the identification of the physical printer the user is close to (Printer ID1).
    <li>(i.e., <i>eID</i> authentication) only if JobID1 contains sensitive information, Steps 9-14 are performed. These steps represent the OIDC authorization code flow performed with the enterprise and the <i>eID</i>.
    <li>(i.e., print request and token validation). If JobID1 contains sensitive information, Steps 15-17 are performed; otherwise, the flow continues with Step 18. In the former case, an additional token (AT<sub>AAC</sub>) is sent to the Print Server and, in Steps 16 and 17, its information is retrieved. In both cases, <i>Print Server</i> obtains the user info associated with the AT<sub>G</sub> token (Step 19-20) and checks (Step 21) whether the user is an Employee of the enterprise (by checking the email domain). If JobID1 contains sensitive information, <i>Print Server</i> also checks that the user authenticated with the <i>eID</i> is the same user authenticated with Google.
    <li>(i.e., job submitting and notification) is represented by Steps 22-26. If the checks are valid, Print Server downloads the job by sending a request to Google Cloud Print (Steps 22- 23) and submits (Step 24) the job to the indicated physical printer by using an admin token (AT<sub>ADMIN</sub>). As the final step, <i>Print Server</i> notifies the user of the successful printing (Steps 25-26).
</ol>
</div>


------
<div style="text-align: center">
    <h3>Security Assessment of each component of the infrastructure</h3>
</div>