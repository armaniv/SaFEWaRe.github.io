{% if page.menubar %}
    {% assign menus = site.data.menus.[page.menubar] %}
{% elsif page.menubarlist %}
    {% assign menus = page.menubarlist %}
{% endif %}

<aside class="menu">
{% for menu in menus %}
    <p class="menu-label">{{ menu.label }}</p>
    <ul class="menu-list">
        {% for item in menu.items %}
        {% capture itemLink %}{{ item.link | remove: ".html" | split: "/" | last }}{% endcapture %}
        {% capture pageLink %}{{ page.url | remove: ".html" | split: "/" | last }}{% endcapture %}
        {% capture pageLinkNoIndex %}{{ page.url | remove: ".html" | remove: "index" | split: "/" | last }}{% endcapture %}
        <li>
            <a href="{{ item.link | prepend: site.baseurl }}" class="{% if itemLink == pageLink or itemLink == pageLinkNoIndex %}is-active{% endif %}">{{ item.name }}</a>
            {% if item.items %}
            <ul>
                {% for subitem in item.items %}
                {% capture subItemLink %}{{ subitem.link | remove: ".html" }}{% endcapture %}
                <li><a href="{{ subitem.link | prepend: site.baseurl }}" class="{% if subItemLink == pageLink or subItemLink == pageLinkNoIndex %}is-active{% endif %}">{{ subitem.name }}</a></li>
                {% endfor %}
            </ul>
            {% endif %}
        </li>
        {% endfor %}    
    </ul>
{% endfor %}
</aside>